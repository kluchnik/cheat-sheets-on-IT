# Intelligence Gathering (Сбор разведданных)

В этом разделе определяются действия по сбору разведданных в рамках теста на проникновение.  

**Сбор разведданных** - это проведение разведки цели с целью сбора как можно большего количества информации, которая будет использована при проникновении в цель на этапах оценки уязвимости и эксплуатации.  
Чем больше информации вы сможете собрать на этом этапе, тем больше векторов атаки вы сможете использовать в будущем.  

## Уровни сбора разделены на три категории:  
* L1 (Уровень 1) - Сбор информации полностью с помощью автоматизированных инструментов
* L2 (Уровень 2) - Уровень 1 + частичный сбор информации с использоанием ручного анализа
* L3 (Уровень 3) - Уровень 1 + Уровень 2 + полный сбор информации с использоанием ручного анализа

## Источники информации могут быть:
* Открытые
* Закрытые или частные

Многие компании и сотрудники не принимают во внимание, какую информацию о себе они размещают публично и как эта информация может быть использована злоумышленником. 

## Получение информации:

* Пассивный сбор информации - доступа к системе нет, всю информацию предоставляет компания. информация может быть устаревшей или неверной, поскольку мы ограничены результатами, полученными от третьей стороны.
* Полупассивный сбор информации - происходит анализ только предоставленных сервисов. Мы не запускаем сканирование портов на сетевом уровне или поисковые роботы, и мы просматриваем только метаданные в опубликованных документах и файлах; не ищем активно скрытый контент.
* Активный сбор информации - составляем карту сетевой инфраструктуры (например, полное сканирование портов nmap –p1-65535), активно перечисляем и/или проверяем на уязвимость открытые сервисы, мы активно ищем неопубликованные каталоги, файлы и серверы. 

### При получении информации необходимо учитывать следующие аcпекты:
* Данные могут содержать неточности и ошибки
* Источниками информации могут намеренно/случайно манипулировать
* Информация может устареть с течением времени или просто быть неполной

## Доступ к системе:
* физические
* электронные
* человеческие

## Выбор цели/процесса:
* Идентификация и присвоение имени цели или процессу
* Выбор оптимальной стратегии для иследования цели
* Растовление приоритетов анализа исходя из критичности и распределения времени исходя из этого

Этап сбора разведданных должен обязательно включать все вторичные и третичные элементы, окружающие конечную цель.  
Будь то вспомогательные технологии, третьи стороны, соответствующий персонал и т.д.

## Стратегия для компаний
### Физический 
* Местоположения (L1) - Получения информации: полный адрес, владельц, связанные записи, полный список всех мер физической безопасности (размещение камер, датчиков, заборов, постов охраны, способ контроля входа, ворот, тип идентификации. Для хостов: Полное обозначение CIDR хостов и сетей, полный список DNS всех связанных активов, полное отображение AS, пиринговые пути, предоставление CDN, владельцы сетевых блоков (данные whois), записи электронной почты (структура MX + mail address)
* * Владелец (L1/L2)
* * Земельные/налоговые записи (L1/L2)
* * Общий/индивидуальный (L1/L2)
* * Часовые пояса (L1/L2)
* * Хосты
* Распределеность (L1) - Нередко целевая организация имеет несколько отдельных физических местоположений. Например, у банка будут центральные офисы, но у них также будет множество удаленных филиалов. В то время как физическая и техническая безопасность может быть очень хорошей в центральных местах, в отдаленных местах часто отсутствует надлежащий контроль безопасности.
* Отношения (L1) - Деловые партнеры, таможня, поставщики, анализ с помощью того, что открыто публикуется на корпоративных веб-страницах, прокатные компании и т.д. Эта информация может быть использована для лучшего понимания бизнеса или организационных проектов. Например, какие продукты и услуги имеют решающее значение для целевой организации? Кроме того, эта информация также может быть использована для создания успешных сценариев социальной инженерии.
* * Отношения (L2/L3) - Ручной анализ для проверки информации с уровня 1, а также углубления в возможные взаимосвязи.
* * Общие офисные помещения (L2/L3)
* * Общая инфраструктура (L2/L3)
* * Арендованное оборудование (L2/L3)

### Логический
Сбор информации о партнеров, клиентов и конкурентов.  
* Деловые партнеры (L1/L2/L3)
* Бизнес-клиенты (L1/L2/L3)
* Конкуренты (L1/L2/L3) - Кто является конкурентами цели.
* Диаграмма связий (L1) (визуальное представление социальных связей между людьми) - Поможет наметить возможные взаимодействия между людьми в организации и способы доступа к ним извне. Данная диаграма позволит определить векторы атаки
* Сбор информации из открытых источников или использования автоматических агрегаторов (L1/L2)
* Линейка продуктов (L2/L3)
* Рыночная отрасль (L1) - В какой отрасли находится цель. например, финансовая, оборонная, сельскохозяйственная, государственная и т.д
* Маркетинговые стратегии (L2/L3)
* Информация о встречах (L2/L3)
* Знаменательные даты компании (L1/L2/L3) - Например: заседания правления, каникулы, юбилеи, запуск продукта/услуги
* Вакансии (L1/L2) - из них можно определить тип технологий, которая использует компания
* Членство в благотворительных организациях (L1/L2/L3) - Эта информация может быть использована для разработки надежных сценариев социальной инженерии для таргетинга на руководителей
* Информация о публичных торгах (L1/L2) - Запросы предложений и часто задаваемые вопросы часто раскрывают много информации о типах систем, используемых компанией, и, возможно, даже о пробелах или проблемах с их инфраструктурой. Выяснение того, кто в настоящее время является победителем торгов, может выявить типы используемых систем или местоположение, где ресурсы компании могут размещаться за пределами площадки.
* Судебные протоколы (L2/L3) - Содержание судебного разбирательства может раскрыть информацию о прошлых заявителях, включая, но не ограничиваясь, судебные иски бывших сотрудников. Судимости нынешних и прошлых сотрудников могут предоставить список целей для усилий по социальной инженерии
* Политические пожертвования (L2/L3) - Отображение политических пожертвований в разных странах будет меняться в зависимости от свободы информации, но часто случаи пожертвований из других стран можно отследить, используя имеющиеся там данные.
* Профессиональные лицензии или реестры (L2/L3)
Сбор списка ваших целевых профессиональных лицензий и реестров может дать представление не только о том, как работала компания, но и о руководствах и положениях, которым они следуют для поддержания этих лицензий. Ярким примером этого является сертификация компаний по стандарту ISO, которая может показать, что компания следует установленным руководящим принципам и процессам

### Организационная схема (L1)
* Идентификация положения
* Важные люди в организации
* Отдельных лиц, специально предназначенных
* Операции
* Отображение изменений внутри организации (продвижение по службе, боковые перемещения)
* Филиалы
* Отображение партнерских организаций, привязанных к бизнесу

### Электронный
Метаданные документа (L1/L2)
Что это такое? Метаданные или мета-контент предоставляют информацию о данных/документе в области видимости. Он может содержать такую информацию, как имя автора / создателя, время и дата, используемые стандарты / ссылки, местоположение в компьютерной сети (принтер / папка / путь к каталогу / и т.д. информация), геотег и т.д. Для изображения его метаданные могут содержать цвет, глубину, разрешение, марку / тип камеры и даже информацию о координатах и местоположении.
Почему вы это сделали? Метаданные важны, поскольку они содержат информацию о внутренней сети, именах пользователей, адресах электронной почты, расположении принтеров и т.д. И помогут создать схему расположения. Он также содержит информацию о программном обеспечении, использованном при создании соответствующих документов. Это может позволить злоумышленнику создать профиль и/или выполнять целевые атаки с использованием внутренних знаний о сетях и пользователях.
Как бы вы это сделали? Существуют инструменты, доступные для извлечения метаданных из файла (pdf / word / image), такие как FOCA (на основе графического интерфейса), metagoofil (на основе python), meta-extractor, exiftool (на основе perl). Эти инструменты способны извлекать и отображать результаты в различных форматах, таких как HTML, XML, графический интерфейс, JSON и т.д. Входные данные для этих инструментов в основном представляют собой документ, загруженный из публичного присутствия "клиента", а затем проанализированный, чтобы узнать о нем больше. В то время как FOCA помогает вам искать документы, загружать и анализировать все через свой графический интерфейс.
Маркетинговые коммуникации (L1/L2)
Прошлые маркетинговые кампании предоставляют информацию о проектах, которые, возможно, были прекращены, но все еще могут быть доступны.
Текущие маркетинговые коммуникации содержат компоненты дизайна (цвета, шрифты, графику и т.д.), которые по большей части используются и внутри компании.
Дополнительная контактная информация, включая внешние маркетинговые организации.

### Инфраструктурные активы
* Принадлежащие сетевые блоки (L1)
* Адреса электронной почты (L1) - Адреса электронной почты предоставляют потенциальный список допустимых имен пользователей и структуру домена
* Профиль внешней инфраструктуры (L1) - Профиль внешней инфраструктуры объекта может предоставить огромную информацию о технологиях, используемых внутри компании. Профиль следует использовать при составлении сценария атаки на внешнюю инфраструктуру.
* Используемые технологии (L1/L2) - Получение из открытых источникоа, автоматизированными сканерами, социальной инженерии к компании и пользователям
* Соглашения о покупке (L1/L2/L3) - Соглашения о покупке содержат информацию об оборудовании, программном обеспечении, лицензиях и дополнительных материальных активах, имеющихся у объекта.
* Удаленный доступ (L1/L2) - Получение информации о том, как сотрудники и/или клиенты подключаются к целевому объекту для удаленного доступа, обеспечивает потенциальную точку входа.
* Использование приложения (L1/L2) - Соберите список известных приложений, используемых целевой организацией. Часто этого можно достичь путем извлечения метаданных из общедоступных файлов (как обсуждалось ранее).
* Защитные технологии (L1/L2/L3) - Двух факторная аунтификация, отпичатки пальцев и пр.
* Пассивная дактилоскопия - Ищите форумы и общедоступную информацию, где технические специалисты целевой организации могут обсуждать проблемы или обращаться за помощью по используемой технологии. Поиск маркетинговой информации для целевой организации, а также популярных поставщиков технологий. Используя Tin-eye (или другой инструмент сопоставления изображений), найдите логотип целевой организации, чтобы узнать, указан ли он на страницах ссылок на поставщиков или в маркетинговых материалах
* ктивная дактилоскопия - Отправьте соответствующие пробные пакеты в общедоступные системы для проверки шаблонов блокировки. Существует несколько инструментов для снятия отпечатков пальцев определенных типов WAF. Информация заголовка как в ответах с целевого веб-сайта, так и в электронных письмах часто содержит информацию не только об используемых системах, но и о конкретных включенных механизмах защиты (например, антивирусные сканеры почтового шлюза).
* Человеческие возможности (L1/L2/L3)
* * Проверьте наличие общекорпоративной команды CERT/CSIRT/PSRT
* * Проверьте наличие объявленных вакансий, чтобы узнать, как часто в списке появляется должность охранника
* * Проверьте наличие объявленных вакансий, чтобы узнать, указана ли безопасность в качестве требования для вакансий, не связанных с безопасностью (например, разработчики)
* * Проверьте наличие соглашений об аутсорсинге, чтобы узнать, была ли безопасность объекта передана на аутсорсинг частично или полностью
* * Проверьте, нет ли конкретных лиц, работающих в компании, которые могут быть активны в сообществе безопасности

### Финансовый
* Отчетность (L1/L2)
* Анализ рынка (L1/L2/L3) - Получайте отчеты по анализу рынка от аналитических организаций (таких как Gartner, IDC, Forrester, 541 и т.д.). Это должно включать определение рынка, рыночную капитализацию, конкурентов и любые серьезные изменения в оценке, продукте или компании в целом.
* Торговый капитал - Определите, распределяет ли организация какой-либо торговый капитал и в каком проценте от общей оценки и свободного капитала она располагает. Это покажет, насколько чувствительна организация к колебаниям рынка и зависит ли она от внешних инвестиций как части ее оценки и движения денежных средств.
* История ценностей - Составление графика оценки организации с течением времени, чтобы установить корреляцию между внешними и внутренними событиями и их влиянием на оценку.
* EDGAR (SEC) (Электронная система сбора, анализа и поиска данных) - это база данных Комиссии по ценным бумагам и биржам США (SEC), которая содержит заявления о регистрации, периодические отчеты и другую информацию обо всех компаниях (как иностранных, так и отечественных), которые по закону обязаны подавать.

## Стратегия для персонала
### История
* Судебные протоколы (L2/L3) - это все общедоступные записи, связанные с уголовными и / или гражданскими жалобами, судебными исками или другими юридическими действиями в пользу или против лица или организации, представляющей интерес. Судебные протоколы потенциально могут раскрыть конфиденциальную информацию, относящуюся к отдельному сотруднику или компании в целом. Эта информация может быть полезна сама по себе или может послужить стимулом для получения дополнительной информации. Он также может быть использован для социальной инженерии или других целей позже в тесте на проникновение.
* Политические пожертвования (L2/L3) - это личные средства физического лица, направленные конкретным политическим кандидатам, политическим партиям или организациям с особыми интересами. Информация о политических пожертвованиях потенциально может раскрыть полезную информацию, связанную с конкретным человеком. Эта информация может быть использована как часть анализа социальных сетей, чтобы помочь установить связи между отдельными лицами и политиками, политическими кандидатами или другими политическими организациями. Он также может быть использован для социальной инженерии или других целей позже в тесте на проникновение.
* Профессиональные лицензии или реестры (L2/L3) - это хранилища информации, которые содержат списки участников и другую связанную с ними информацию о лицах, которые получили определенную лицензию или определенную степень принадлежности к сообществу. Информация о профессиональных лицензиях потенциально может раскрыть полезную информацию, связанную с конкретным лицом. Эта информация может быть использована для проверки надежности человека (действительно ли у него есть определенный сертификат, как они утверждают) или как часть анализа социальных сетей, чтобы помочь установить связи между отдельными лицами и другими организациями. Он также может быть использован для социальной инженерии или других целей позже в тесте на проникновение.

### Профиль в социальной сети (SocNet)
* Утечка метаданных (L2/L3) - Информация о местоположении с помощью метаданных фотографий
* Тон (L2/L3) - субъективная идентификация тона, используемого в общении – агрессивный, пассивный, привлекательный, продающий, восхваляющий, осуждающий, снисходительный, высокомерный, элитарный, аутсайдер, лидер, последователь, подражающий и т.д.
* Частота (L2/L3) - Определение частоты публикаций (раз в час/день/неделю и т.д.). Дополнительно - время дня / недели, в которое возможны сообщения.
* Осведомленность о местоположении (L2/L3) - Нанесите на карту историю местоположения человека, составленную из различных источников, будь то посредством прямого взаимодействия с приложениями и социальными сетями или посредством пассивного участия с помощью метаданных фотографий.
* Присутствие в социальных сетях (L1/L2/L3)
* * Подтвердите учетную запись/присутствие цели в социальных сетях (L1)
* * И предоставить подробный анализ (L2/L3)
* Присутствие в Интернете
* * Адрес электронной почты (L1) - это идентификаторы общедоступных почтовых ящиков пользователей. Сбор или поиск адреса электронной почты важен, потому что он служит нескольким целям - предоставляет вероятный формат идентификатора пользователя, который впоследствии может быть принудительно получен для доступа, но, что более важно, он помогает отправлять целевые спамы и даже автоматизированным ботам. Эти спам-письма могут содержать эксплойты, вредоносные программы и т.д. И могут быть адресованы с определенным содержанием, особенно пользователю.
* * Личные дескрипторы/Ники (L1)
* * Зарегистрированные персональные доменные имена (L1/L2)
* * Назначенные статические IP-адреса/сетевые блоки (L1/L2)
* Физическое местоположение
* Мобильный след
* * Номер телефона (L1/L2/L3)
* * Тип устройства (L1/L2/L3)
* * Использование (L1/L2/L3)
* * Установленные приложения (L1/L2/L3)
* * Владелец/администратор (L1/L2/L3)
