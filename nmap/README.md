# Применение nmap

## Использование скриптов:
```(bash)
nmap --script <name_script> -sV -p <port> <host>
```
Список скриптов расположен в /usr/share/nmap/scripts/

Пример проверки ssh-сертификата:  
```(bash)
nmap --script ssl-cert,ssl-enum-ciphers -sV -p <port> <host>
```

| Команда | | Описание |
| - | - | - |
| ```nmap -p22,23,25,80,3389 --traceroute -PN <target>``` | Быстрая трассировка | TCP SYN сканирование портов 22,23,25,80,3389 с трассировкой. Обнаружение активных хостов не производится (все хосты, указанные в качестве цели считаются активными и будут просканированы). |
| ```nmap -T4 -F <target>``` | Быстрое сканирование | TCP SYN сканирование по списку наиболее используемых TCP портов. Обнаружение активных хостов проводится по методам ICMP echo request (ping) и TCP ACK на порт 80. |
| ```nmap -T4 --version-light -sV -F -O <target>``` | Быстрое сканирование плюс | TCP SYN сканирование по списку наиболее используемых портов, с определением запущенных на этих портах служб и их версий, а также определением операционной системы сканируемого хоста. Обнаружение активных хостов проводится по методам ICMP echo request (ping) и TCP ACK на порт 80. |
| ```nmap -PE - PA21,23,80,3389 -A -v -T4 <target>``` | Интенсивное сканирование | TCP SYN сканирование портов 1-1024, а также по списку наиболее используемых портов с определением запущенных на этих портах служб и их версий, определением операционной системы, трассировкой и использованием NSE скриптов из набора default. Обнаружение активных хостов проводится по методам ICMP echo request (ping) и TCP ACK на порты 21,23,80,3389. |
| ```nmap -A -v -PN -T4 <target>``` | Интенсивное сканирование без пинга | TCP SYN сканирование портов 1-1024, а также по списку наиболее используемых портов с определением запущенных на этих портах служб и их версий, определением операционной системы, трассировкой и использованием NSE скриптов из набора default. Обнаружение активных хостов не производится (все хосты, указанные в качестве цели считаются активными и будут просканированы). |
| ```nmap -PE -v -PA21,23,80,3389 -sU -sS -A -T4 <target>``` | Интенсивное сканирование и UDP | TCP SYN и UDP сканирование портов 1-1024, а также по списку наиболее используемых портов с определением запущенных на этих портах служб и их версий, определением операционной системы, трассировкой и использованием NSE скриптов из набора default. Обнаружение активных хостов проводится по методам ICMP echo request (ping) и TCP ACK на порты 21,23,80,3389. |
| ```nmap -PE -v -p1-65535 -PA21,23,80,3389 -A -T4 <target>``` | Интенсивное сканирование, все TCP порты | TCP SYN сканирование всех портов (1-65535) с определением запущенных на этих портах служб и их версий, определением операционной системы, трассировкой и использованием NSE скриптов из набора default. Обнаружение активных хостов проводится по методам ICMP echo request (ping) и TCP ACK на порты 21,23,80,3389. |
| ```nmap -PE -v -PS21,22,23,25,80,113,31339 --script=all -PO -PA80,113,443,10042 -sU -sS -PP -A -T4 <target>``` | Медленное полное сканирование | TCP SYN и UDP сканирование портов 1-1024, а также по списку наиболее используемых портов с определением запущенных на этих портах служб и их версий, определением операционной системы, трассировкой и использованием всех NSE скриптов. Обнаружение активных хостов проводится по методам ICMP echo request (ping), ICMP timestamp, запросов по протоколу IP, TCP ACK на порты 80,113,443,10042 и TCP SYN на порты 21,22,23,25,80,113,31339. |
| ```nmap -PE -PA21,23,80,3389 -sP <target>``` | Обнаружение узлов | Обнаружение активных хостов по методам ICMP echo request (ping) и TCP ACK на порты 21,23,80,3389. Никаких действий после обнаружения (сканирование портов, определение ОС, служб и т.д.) не производится. |
| ```nmap <target>``` | Обычное сканирование | TCP SYN сканирование портов 1-1024, а также по списку наиболее используемых портов. Обнаружение активных хостов проводится по методам ICMP echo request (ping) и TCP ACK на порт 80. |
